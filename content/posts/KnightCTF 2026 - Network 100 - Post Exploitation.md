+++
date = 2026-01-21
description ="KnightCTF 2026 - Network 100 - Post Exploitation"
title = "KnightCTF 2026 - Network 100 - Post Exploitation"
[taxonomies]
tags = ["ctf", "networking", "wireshark", "tshark"]
+++
## Task

```
## Post-Exploitation

### 100 Points

Author

After exploiting the vulnerability, the attacker established a persistent connection back to their command and control server. Analyze the traffic to identify the HTTP port used for the initial payload delivery and the port used for the reverse shell connection.

Download: [pcap3.pcapng](https://drive.google.com/file/d/1Xr1onCDIvTvMviH1k16mIjH2P2tfQZuq/view?usp=sharing)

**Flag Format: KCTF{httpPort_revshellPort}**
```


https://drive.google.com/file/d/1Xr1onCDIvTvMviH1k16mIjH2P2tfQZuq/view?usp=sharing


## WireShark dump

Since it's wordpress in question, i assumed that shell was uploaded from that Social Warfare plugin we already figured out previously, which means by http.
So i started filtering out by POST,  GET and looking around, and it couldn't be more obvious:
![](/images/2a7ba68a114d37e816a2f96a8b85285b.png)

This already gives us http port for payload **8786**, which is half the flag. Now we need to find reverse shell port, and to narrow it down we want to:

- look after timestamp of a payload, since revese shell can only be invoked after uploading obviously, in screenshot you can see timestamp: **882**
   `( frame.time_relative > 882)`
   
- `!(tcp.port==80 || tcp.port==8767)` - exclude port 80 and payload port 8786
 - `ip.src==192.168.1.102`  - Only traffic from the victim.
- `ip.dst==192.168.1.104` - Only traffic going to the attacker.

We will also filter multiple mentions of the same port number with sort -u :

```bash
~/Vault/isec/ctf/knight2k26/net100-exploitation  âœ“ $ tshark -r pcap3.pcapng -Y "ip.src==192.168.1.102 && ip.dst==192.168.1.104 && tcp && frame.time_relative>882 && !(tcp.port==80 || tcp.port==8767)" -T fields -e tcp.srcport -e tcp.dstport | sort -u

     9576

```

And there it is, reverse shell port **9576**

Note:
You can filter with `sort | uniq -c` if you want to display number of packets sent and ephemeral port.
## Flag

Flag is: KCTF{8767_9576}

![](/images/7be91c4aef1cc1f6451c0cd389d0ef49.png)